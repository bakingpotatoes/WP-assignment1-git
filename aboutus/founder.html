<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>About Me</title>
    <link rel="stylesheet" href="./founder.css">
</head>
    <body>
        <div class="side-nav" id="side-nav">
            <nav>
                <div>
                    <!--Put this in a div so you can resize the container itself anytime-->
                    <img id="home-image-button" src="../images/Untitled.png" alt="Home">
                </div>
                <div>
                    <img id="contact-image-button" src="../images/Untitled.png" alt="Contact">
                </div>
                <div>
                    <img id="aboutus-image-button" src="../images/Untitled.png" alt="AboutUs">
                </div>
                <div>
                    <img id="shop-image-button" src="../images/Untitled.png" alt="Shop">
                </div>
            </nav>
        </div>
        <div class="context-menu" id="context">
            <article></article>

        </div>
        <div class="main-body">
            <header>
                <div class="photo-catalog">
                    <section>
                        <img src="../images/Untitled.png" alt="">
                        <img src="../images/Untitled.png" alt="">
                    </section>
                    <section>
                        <img src="../images/Untitled.png" alt="">
                        <img src="../images/Untitled.png" alt="">
                    </section>
                </div>
            </header>
            <div class="profile-banner" id="profile-banner">
                <section id="profile-frame">
                    <img id="profile-picture" class="profile-picture" src="../images/istockphoto-1300845620-612x612.jpg" alt="">
                    <h1>Keith Chan</h1>
                    <p style="color: rgba(0, 0, 0, 0.463);"><i>Founder</i></p>
                    <div class="socials-container" id="socials-container">
                        <div id="instagram" onmouseover="socialStyles(event)" onmouseout="socialStyles(event)"><img style="filter: invert(1);" src="../images/instagram-icon.jpg" alt="" onclick="window.replace()"></div>
                        <div id="linkedin" onmouseover="socialStyles(event)" onmouseout="socialStyles(event)"><img style="filter: invert(1);" src="../images/linkedin-icon.png" alt="" onclick="window.replace()"></div>
                        <div id="twitter" onmouseover="socialStyles(event)" onmouseout="socialStyles(event)"><img style="filter: invert(0); background-image: none; background-color: transparent;" src="../images/twitter-icon.png" alt="" onclick="window.replace()"></div>
                    </div>

                </section>
                <article id="profile-info-box">
                    <section id="introduction-box">
                        My Introduction
                    </section>
                    <section id="timeline-box">
                        My Timeline
                    </section>
                    <section id="interests-box">
                        Personal Interests
                    </section>
                    <section id="test">
                        Personal Interests
                    </section>
                </article>
            </div>

            <!-- user profile button -->
            <div class="user-profile">
                <img id="user-profile-icon" src="../images/istockphoto-1300845620-612x612.jpg" alt="" onclick="">
                <img id="photo-viewer" src="../images/photo-viewer.jpg" alt="" onclick="">
            </div>
            <div class="svg-arrow" onclick="">
                <svg viewBox="0 0 70 70" fill="none">
                    <path id="svg-arrow-line" /> <!-- "/>" is just the closing tag in the opening tag, very useful for elements that don't have inner values-->
                    <path id="svg-arrow-tip" /> 
                </svg>
            </div>
        </div>

        <script type="text/javascript">
            let navCont = document.getElementById("side-nav");
            let contextCont = document.getElementById("context");
            let userProfileButton = document.querySelector("#user-profile-icon")
            let maxWidth = navCont.offsetWidth;
            let minWidth = maxWidth - contextCont.offsetWidth;

            // let objectChecker = {
            //     "socials-container" : () => {
            //         let social
            //         if () {

            //         }
            //     },

            // }
            let mainBody = document.querySelector(".main-body");
            let profileBanner = document.querySelector("#profile-banner")
            let profilePicture = document.querySelector("#profile-banner > section")
            let photoViewer = document.querySelector("#photo-viewer")
            let animTimeAxis = minWidth; //most right digit is ALWAYS the miliseconds in hundrenths, other digits are seconds, when theres only 1 digit, its 0 seconds + N hundred miliseconds
            let timer
            const context = document.querySelector("#context");
            const elementObjects = { //THIS STORES MY OBJECTS THAT CAN BE INTERACTED WITH ^^ im so happy yay
                //contains objectid, directTo when clicked, (for context menu only: a title, and a context text)
                "home-image-button" : [document.getElementById("home-image-button"), "../index/index.html", createContextContent("<b>Go home</b> <br> View our homepage again!")],
                "contact-image-button" : [document.getElementById("contact-image-button"), "../contact/contact.html", createContextContent("<b>Contact Us!</b> <br> Apply for a form or get our contact information")],
                "aboutus-image-button" : [document.getElementById("aboutus-image-button"), "../aboutus/aboutus.html", createContextContent("<b>About Us</b> <br> Learn more about us as people; our hobbies and timeline!")],
                "shop-image-button" : [document.getElementById("shop-image-button"), "../shop/shop.html", createContextContent("<b>Shop</b> <br> Take a look around our small shoplet!")]
            }
            // FOR ANIMATIONS, USE A SINE FUNCTION AS TIME JUXAPOSED TO RATE OF CHANGE

            function clamp(value, min, max) {
                if (min != null && value < min) {       //NOTE: make it so that it can accept two arguments at once and works as intended// 
                    return min;
                }
                if (max != null && value > max) {
                    return max;
                }
                return value;
            }

            function createContextContent(title, description) {
                let contextMenuContent = {
                    "label" : title 
                }
                return contextMenuContent;
            }

            function moveContext(event) {
                let ID = event.currentTarget.id;
                let navIcon = document.getElementById(ID)
                let translateSpeed = 10;
                if (event.type === "mouseenter") {
                    let targetRect = document.getElementById(ID);
                    let rectClientDimension = targetRect.getBoundingClientRect();
                    let contextContent = document.querySelector("#context > article")
                    clearInterval(timer); //MAKE SURE TO ALWAYS CLEARINTERVAL() OR YOU COULD BE SETTING UP MORE THAN ONE SETINTERVAL() AT A TIME
                    timer = setInterval(() => {animTimeAxis = clamp(value=(animTimeAxis + translateSpeed), min=minWidth, max=(maxWidth))}, 10); //stored in a variable so we can stop the timer later
                    contextContent.innerHTML = String(elementObjects[ID][2]["label"]);
                    contextContent.style.top = String(rectClientDimension.top.toFixed() + "px");

                    //as long as mouse is on element, increment timer, pass it through a function that determines the y position (the viewport position) based on a sine function
                } else if (event.type === "mouseout") {
                    clearInterval(timer); //MAKE SURE TO ALWAYS CLEARINTERVAL() OR YOU COULD BE SETTING UP MORE THAN ONE SETINTERVAL() AT A TIME
                    timer = setInterval(() => {animTimeAxis = clamp(value=(animTimeAxis - translateSpeed), min=minWidth, max=(maxWidth))}, 10);

                } else if (event.type === "click") {
                    clearInterval(timer);
                    location.replace(elementObjects[String(ID)][1]);
                }
                    
            }
            for (const element in elementObjects) { //(any declarations;, condition for the loop to keep going;, alter anything to make sure the loop may end;) OR (const blockVar in Matrix)
                let EL = elementObjects[element][0];
                EL.addEventListener("click", moveContext); //APPARENTLY, CALLING A FUNCTION LIKE THIS IS JUST "REFERENCING IT", DON'T DO moveContext(event) OR YOU WOULD BE CALLING IT WITHOUT PARAMETERS IMMEDIATELY APPARENTLY ToT
                EL.addEventListener("mouseenter", moveContext); //Ig this is a "addEventListener constructor", the first argument to be passed in is ALWAYS the event object ToT wtffff is this shitt
                EL.addEventListener("mouseout", moveContext); //i want to kill the people who made js

            }



            function toggleSocials(setMode) { //this function makes it so that when you scroll down, the social media buttons transition into frame, takes external conditions besides a mode parameter
                let socialsContainer = document.querySelector("#socials-container").childNodes;
                for (let i = 0; i < socialsContainer.length; i++) {
                    if (socialsContainer[i].id != undefined) {
                        if (setMode) {
                            document.getElementById(String(socialsContainer[i].id)).style.animationName = "appearIn";
                            document.getElementById(String(socialsContainer[i].id)).style.pointerEvents = "all";
                        } else {
                            document.getElementById(String(socialsContainer[i].id)).style.animationName = "appearOut";
                            document.getElementById(String(socialsContainer[i].id)).style.pointerEvents = "none";
                        }
                    }
                }
            }


            function initialiseContentBoxes() { //this for now just changes the opacity of the content boxes when they arrive into viewing range
                // fire initialisation when this box is at a certain distance from the top, and provided that the socials-container has already initialised
                let profileInformationContainer = document.querySelector("#profile-info-box").childNodes;
                for (let i = 0; i < profileInformationContainer.length; i++) {
                    if (profileInformationContainer[i].id != undefined) {
                        
                        let child = document.getElementById(profileInformationContainer[i].id);
                        let innerContentDist = parseFloat(window.innerHeight - child.getBoundingClientRect().top.toFixed());
                        let getContentHeight = parseFloat(child.getBoundingClientRect().height.toFixed());
                        if (innerContentDist / getContentHeight > 0.35) {
                            child.style.animationName = "reverse-contentBoxCompleteFade";
                        } else {
                            child.style.animationName = "contentBoxCompleteFade";
                        }
                    }
                }
            }

            function socialStyles(event) { //this function makes it so that the social icons change background color and filter when hovered over
                let ID = event.currentTarget.id;
                let targetSocial = document.getElementById(ID);
                let targetImg = document.querySelector(`#${ID} > img`);
                
                if (event.target.id === ID) {
                    let currInvertVAL;
                    let invertVAL;
                    let invertOBJ = getComputedStyle(targetImg).filter;
                    for (let i = 0; i < String(invertOBJ).length; i++) {
                        if (isFinite(parseFloat(invertOBJ[i]))) { //Checks if the character is a number (isFinite()), assuming int/float with a toFixed()
                            invertVAL = invertOBJ[i];
                            if (invertVAL == 0) {
                                currInvertVAL = 1;
                            } else {
                                currInvertVAL = 0;
                            }
                            targetImg.style.filter = `invert(${currInvertVAL})`;
                        }
                    }

                    if (event.type == "mouseover") {
                        targetSocial.animate(
                            [
                                {backgroundColor : "rgba(255,255,255,1)"},
                                {backgroundColor: "rgba(0,0,0,0.7)"}
                            ], {
                                duration: 500,
                                iterations: 1,
                                fill: "both"
                            }
                        );
                    } else {
                        targetSocial.animate(
                            [
                                {backgroundColor : "rgba(0,0,0,0.7)"},
                                {backgroundColor: "rgba(255,255,255,1)"}
                            ], {
                                duration: 500,
                                iterations: 1,
                                fill: "both"
                            }
                        );
                    }
                };
                


            }

            let reachedBottom = false
            function dynamicNavArrow() {
                let contentContainers = document.querySelector("#profile-info-box").children;
                let containerIDs = new Array();
                let lastContainer;
                let bufferDist = 100; //export this value to the programmer to modify for QoL

                let arrowLine = document.querySelector("#svg-arrow-line")
                let arrowTip = document.querySelector("#svg-arrow-tip")
                let arrowBoth = document.querySelector(".svg-arrow")

                for (let i = 0; i < contentContainers.length; i++) {
                    containerIDs.push(contentContainers[i]);
                }
                lastContainer = document.getElementById(containerIDs[containerIDs.length - 1].id); //for some strange reason, you can't index an array, tuple, dict or anything iterable with -1!!!
                // getBoundingClientRect gets the distance of bottom and top parts of a container to the TOP of the webpage
                //-> for left and right, it gets the distance to the LEFT side of the webpage
                let lastContainerBottom = parseFloat(window.innerHeight - lastContainer.getBoundingClientRect().bottom.toFixed() + bufferDist); 
                //distance of bottom of the last container to the bottom of the page
                if (lastContainerBottom >= 0) {
                    arrowTip.style.animationName = "svg-ARROWTIP-upwards";
                    arrowBoth.style.animationName = "svg-ARROWBOTH-down";
                    reachedBottom = true;

                } else if (lastContainerBottom <= 0 && reachedBottom) {
                    arrowTip.style.setProperty("d", "M5 35L35 65L65 35");
                    arrowTip.style.animationName = "svg-ARROWTIP-downwards";
                    arrowBoth.style.animationName = "svg-ARROWBOTH-up";

                }

            }
            

            // window responsive events
            window.onscroll = function() {
                initialiseContentBoxes();
                dynamicNavArrow();
                (() => {

                    if (profileBanner.getBoundingClientRect().top.toFixed() <= 250) {
                        photoViewer.style.animationName = "completeFade";
                        photoViewer.disabled = true;
                        toggleSocials(true);
                    } else if (profileBanner.getBoundingClientRect().top.toFixed() >= 250) {
                        photoViewer.style.animationName = "reverse-completeFade";
                        photoViewer.disabled = false;
                        toggleSocials(false);
                    }


                })()  //placed in an arrow function for fun


                profilePicture.style.bottom = String(clamp(value=profileBanner.getBoundingClientRect().top.toFixed(), min=-100, max=130) + "px");




            }


            // update per 10ms
            setInterval(() => { //this will be my defacto update cycle asynch function
                context.style.left = String(animTimeAxis + "px");
            }, 10);



        </script>
    </body>
</html>